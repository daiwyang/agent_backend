graph TD
    %% 节点样式定义
    classDef inputNode fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    classDef inputNodeOptional fill:#e0f2f1,stroke:#00695c,stroke-width:2px,stroke-dasharray: 5 3
    classDef outputNode fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px
    classDef outputNodeOptional fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px,stroke-dasharray: 5 3
    classDef callNode fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef varNode fill:#f3e5f5,stroke:#7b1fa2,stroke-width:1px
    classDef varNodeOptional fill:#f3e5f5,stroke:#7b1fa2,stroke-width:1px,stroke-dasharray: 5 3
    classDef conditionalNode fill:#ffecb3,stroke:#f57c00,stroke-width:2px
    classDef scatterNode fill:#f8bbd9,stroke:#ad1457,stroke-width:2px

    input_SN["Input: SN"]
    class input_SN inputNode
    input_RegistJson["Input: RegistJson"]
    class input_RegistJson inputNode
    input_DataDir["Input: DataDir"]
    class input_DataDir inputNode
    input_ImageTar["Input: ImageTar"]
    class input_ImageTar inputNode
    input_ImagePreDir["Input: ImagePreDir"]
    class input_ImagePreDir inputNode
    input_Tissue["Input: Tissue"]
    class input_Tissue inputNode
    input_Reference["Input: Reference"]
    class input_Reference inputNode
    var_Outdir("Outdir")
    class var_Outdir varNode
    var_SNID("SNID")
    class var_SNID varNode
    var_ImagePre("ImagePre")
    class var_ImagePre varNode
    var_Species("Species")
    class var_Species varNode
    var_dockerUrl("dockerUrl")
    class var_dockerUrl varNode
    cond_1{"read_bo..."}
    class cond_1 conditionalNode
    task_GetPreVersion["GetPreVersion"]
    class task_GetPreVersion callNode
    task_Link["Link"]
    class task_Link callNode
    task_ReRegister_v3["ReRegister_v3"]
    class task_ReRegister_v3 callNode
    task_TissueCut["TissueCut"]
    class task_TissueCut callNode
    task_SpatialCluster["SpatialCluster"]
    class task_SpatialCluster callNode
    task_CellCut["CellCut"]
    class task_CellCut callNode
    task_CellCluster["CellCluster"]
    class task_CellCluster callNode
    task_Saturation["Saturation"]
    class task_Saturation callNode
    task_Report_v2["Report_v2"]
    class task_Report_v2 callNode
    output_out03["Output Group: out03 - 1 items"]
    class output_out03 outputNodeOptional
    output_out04["Output Group: out04 - 1 items"]
    class output_out04 outputNodeOptional
    output_out041["Output Group: out041 - 1 items"]
    class output_out041 outputNodeOptional
    output_out05["Output Group: out05 - 1 items"]
    class output_out05 outputNodeOptional
    output_out051["Output Group: out051 - 1 items"]
    class output_out051 outputNodeOptional
    output_out06["Output Group: out06 - 1 items"]
    class output_out06 outputNodeOptional
    output_out07["Output Group: out07 - 1 items"]
    class output_out07 outputNodeOptional

    input_SN --> var_SNID
    input_ImagePreDir --> var_ImagePre
    input_Reference --> var_Species
    task_GetPreVersion --> cond_1
    cond_1 -.-> task_CellCut
    cond_1 -.-> task_CellCluster
    input_DataDir --> task_GetPreVersion
    var_dockerUrl --> task_GetPreVersion
    input_DataDir --> task_Link
    var_SNID --> task_Link
    var_dockerUrl --> task_Link
    var_SNID --> task_ReRegister_v3
    input_RegistJson --> task_ReRegister_v3
    input_ImageTar --> task_ReRegister_v3
    input_DataDir --> task_ReRegister_v3
    var_ImagePre --> task_ReRegister_v3
    var_dockerUrl --> task_ReRegister_v3
    task_Link --> task_TissueCut
    var_SNID --> task_TissueCut
    task_ReRegister_v3 --> task_TissueCut
    var_ImagePre --> task_TissueCut
    var_dockerUrl --> task_TissueCut
    task_TissueCut --> task_SpatialCluster
    var_SNID --> task_SpatialCluster
    var_dockerUrl --> task_SpatialCluster
    task_Link --> task_CellCut
    var_SNID --> task_CellCut
    task_ReRegister_v3 --> task_CellCut
    var_ImagePre --> task_CellCut
    var_dockerUrl --> task_CellCut
    task_CellCut --> task_CellCluster
    var_SNID --> task_CellCluster
    var_ImagePre --> task_CellCluster
    var_dockerUrl --> task_CellCluster
    task_Link --> task_Saturation
    task_TissueCut --> task_Saturation
    var_dockerUrl --> task_Saturation
    var_dockerUrl --> task_Report_v2
    task_Link --> task_Report_v2
    task_TissueCut --> task_Report_v2
    task_SpatialCluster --> task_Report_v2
    task_Saturation --> task_Report_v2
    task_ReRegister_v3 --> task_Report_v2
    var_SNID --> task_Report_v2
    task_CellCut --> task_Report_v2
    task_CellCluster --> task_Report_v2
    input_Tissue --> task_Report_v2
    var_Species --> task_Report_v2
    task_ReRegister_v3 --> output_out03
    task_TissueCut --> output_out04
    task_CellCut --> output_out041
    task_SpatialCluster --> output_out05
    task_CellCluster --> output_out051
    task_Saturation --> output_out06
    task_Report_v2 --> output_out07